# AI μ›ν¬ν”λ΅μ° λ³΄μ•: λ¨λΈ μ»¨ν…μ¤νΈ ν”„λ΅ν† μ½ μ„λ²„λ¥Ό μ„ν• Entra ID μΈμ¦

## μ†κ°
λ¨λΈ μ»¨ν…μ¤νΈ ν”„λ΅ν† μ½(MCP) μ„λ²„λ¥Ό λ³΄νΈν•λ” κ²ƒμ€ μ§‘μ ν„κ΄€λ¬Έμ„ μ κ·Έλ” κ²ƒλ§νΌ μ¤‘μ”ν•©λ‹λ‹¤. MCP μ„λ²„λ¥Ό μ—΄μ–΄λ‘λ©΄ λ„κµ¬μ™€ λ°μ΄ν„°κ°€ λ¬΄λ‹¨ μ•΅μ„Έμ¤μ— λ…Έμ¶λμ–΄ λ³΄μ• μΉ¨ν•΄λ΅ μ΄μ–΄μ§ μ μμµλ‹λ‹¤. Microsoft Entra IDλ” κ°•λ ¥ν• ν΄λΌμ°λ“ κΈ°λ° ID λ° μ•΅μ„Έμ¤ κ΄€λ¦¬ μ†”λ£¨μ…μ„ μ κ³µν•μ—¬, μΉμΈλ μ‚¬μ©μ λ° μ• ν”λ¦¬μΌ€μ΄μ…λ§ MCP μ„λ²„μ™€ μƒνΈ μ‘μ©ν•  μ μλ„λ΅ λ³΄μ¥ν•©λ‹λ‹¤. μ΄ μ„Ήμ…μ—μ„λ” Entra ID μΈμ¦μ„ μ‚¬μ©ν•μ—¬ AI μ›ν¬ν”λ΅μ°λ¥Ό λ³΄νΈν•λ” λ°©λ²•μ„ λ°°μ›λ‹λ‹¤.

## ν•™μµ λ©ν‘
μ΄ μ„Ήμ…μ„ λ§μΉλ©΄ λ‹¤μμ„ μν–‰ν•  μ μμµλ‹λ‹¤:

- MCP μ„λ²„ λ³΄μ•μ μ¤‘μ”μ„± μ΄ν•΄
- Microsoft Entra ID λ° OAuth 2.0 μΈμ¦μ κΈ°λ³Έ μ‚¬ν•­ μ„¤λ…
- κ³µκ° ν΄λΌμ΄μ–ΈνΈμ™€ κΈ°λ°€ ν΄λΌμ΄μ–ΈνΈμ μ°¨μ΄μ  μΈμ‹
- λ΅μ»¬(κ³µκ° ν΄λΌμ΄μ–ΈνΈ) λ° μ›κ²©(κΈ°λ°€ ν΄λΌμ΄μ–ΈνΈ) MCP μ„λ²„ μ‹λ‚λ¦¬μ¤ λ¨λ‘μ—μ„ Entra ID μΈμ¦ κµ¬ν„
- AI μ›ν¬ν”λ΅μ° κ°λ° μ‹ λ³΄μ• λ¨λ²” μ‚¬λ΅€ μ μ©

## λ³΄μ• λ° MCP

μ§‘μ ν„κ΄€λ¬Έμ„ μ κ·Έμ§€ μ•κ³  λ‘μ§€ μ•λ” κ²ƒμ²λΌ, MCP μ„λ²„λ¥Ό λ„κµ¬μ—κ²λ‚ μ—΄μ–΄λ‘μ–΄μ„λ” μ• λ©λ‹λ‹¤. AI μ›ν¬ν”λ΅μ°λ¥Ό λ³΄νΈν•λ” κ²ƒμ€ κ°•λ ¥ν•κ³  μ‹ λΆ°ν•  μ μμΌλ©° μ•μ „ν• μ• ν”λ¦¬μΌ€μ΄μ…μ„ κµ¬μ¶•ν•λ” λ° ν•„μμ μ…λ‹λ‹¤. μ΄ μ¥μ—μ„λ” Microsoft Entra IDλ¥Ό μ‚¬μ©ν•μ—¬ MCP μ„λ²„λ¥Ό λ³΄νΈν•κ³ , μΉμΈλ μ‚¬μ©μ λ° μ• ν”λ¦¬μΌ€μ΄μ…λ§ λ„κµ¬ λ° λ°μ΄ν„°μ™€ μƒνΈ μ‘μ©ν•  μ μλ„λ΅ ν•λ” λ°©λ²•μ„ μ†κ°ν•©λ‹λ‹¤.

## MCP μ„λ²„μ— λ³΄μ•μ΄ μ¤‘μ”ν• μ΄μ 

MCP μ„λ²„μ— μ΄λ©”μΌμ„ λ³΄λ‚΄κ±°λ‚ κ³ κ° λ°μ΄ν„°λ² μ΄μ¤μ— μ•΅μ„Έμ¤ν•  μ μλ” λ„κµ¬κ°€ μλ‹¤κ³  μƒμƒν•΄ λ³΄μ‹­μ‹μ¤. λ³΄μ•λμ§€ μ•μ€ μ„λ²„λ” λ„κµ¬λ‚ ν•΄λ‹Ή λ„κµ¬λ¥Ό μ μ¬μ μΌλ΅ μ‚¬μ©ν•  μ μμμ„ μλ―Έν•λ©°, μ΄λ” λ¬΄λ‹¨ λ°μ΄ν„° μ•΅μ„Έμ¤, μ¤νΈ λλ” κΈ°νƒ€ μ•…μμ μΈ ν™λ™μΌλ΅ μ΄μ–΄μ§ μ μμµλ‹λ‹¤.

μΈμ¦μ„ κµ¬ν„ν•¨μΌλ΅μ¨ μ„λ²„μ— λ€ν• λ¨λ“  μ”μ²­μ΄ ν™•μΈλκ³ , μ”μ²­μ„ ν•λ” μ‚¬μ©μ λλ” μ• ν”λ¦¬μΌ€μ΄μ…μ IDκ°€ ν™•μΈλ©λ‹λ‹¤. μ΄λ” AI μ›ν¬ν”λ΅μ°λ¥Ό λ³΄νΈν•λ” μ²« λ²μ§Έμ΄μ κ°€μ¥ μ¤‘μ”ν• λ‹¨κ³„μ…λ‹λ‹¤.

## Microsoft Entra ID μ†κ°

[**Microsoft Entra ID**](https://adoption.microsoft.com/microsoft-security/entra/)λ” ν΄λΌμ°λ“ κΈ°λ° ID λ° μ•΅μ„Έμ¤ κ΄€λ¦¬ μ„λΉ„μ¤μ…λ‹λ‹¤. μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ„ν• λ²”μ© λ³΄μ• μ”μ›μ΄λΌκ³  μƒκ°ν•μ‹­μ‹μ¤. μ‚¬μ©μ IDλ¥Ό ν™•μΈ(μΈμ¦)ν•κ³  ν—μ©λ μ‘μ—…μ„ κ²°μ •(κ¶ν• λ¶€μ—¬)ν•λ” λ³µμ΅ν• ν”„λ΅μ„Έμ¤λ¥Ό μ²λ¦¬ν•©λ‹λ‹¤.

Entra IDλ¥Ό μ‚¬μ©ν•λ©΄ λ‹¤μμ„ μν–‰ν•  μ μμµλ‹λ‹¤:

- μ‚¬μ©μλ¥Ό μ„ν• μ•μ „ν• λ΅κ·ΈμΈ ν™μ„±ν™”
- API λ° μ„λΉ„μ¤ λ³΄νΈ
- μ¤‘μ•™ μ„μΉμ—μ„ μ•΅μ„Έμ¤ μ •μ±… κ΄€λ¦¬

MCP μ„λ²„μ κ²½μ° Entra IDλ” μ„λ²„ κΈ°λ¥μ— μ•΅μ„Έμ¤ν•  μ μλ” μ‚¬λμ„ κ΄€λ¦¬ν•κΈ° μ„ν• κ°•λ ¥ν•κ³  λ„λ¦¬ μ‹ λΆ°λ°›λ” μ†”λ£¨μ…μ„ μ κ³µν•©λ‹λ‹¤.

---

## λ§λ²• μ΄ν•΄: Entra ID μΈμ¦ μ‘λ™ λ°©μ‹

Entra IDλ” **OAuth 2.0**κ³Ό κ°™μ€ κ°λ°©ν• ν‘μ¤€μ„ μ‚¬μ©ν•μ—¬ μΈμ¦μ„ μ²λ¦¬ν•©λ‹λ‹¤. μ„Έλ¶€ μ‚¬ν•­μ€ λ³µμ΅ν•  μ μμ§€λ§ ν•µμ‹¬ κ°λ…μ€ κ°„λ‹¨ν•λ©° λΉ„μ λ¥Ό ν†µν•΄ μ΄ν•΄ν•  μ μμµλ‹λ‹¤.

### OAuth 2.0μ— λ€ν• κ°„λµν• μ†κ°: λ°λ › ν‚¤

OAuth 2.0μ„ μλ™μ°¨ λ°λ › μ„λΉ„μ¤μ™€ κ°™λ‹¤κ³  μƒκ°ν•μ‹­μ‹μ¤. λ μ¤ν† λ‘μ— λ„μ°©ν–μ„ λ• λ°λ ›μ—κ² λ§μ¤ν„° ν‚¤λ¥Ό μ£Όμ§€ μ•μµλ‹λ‹¤. λ€μ‹  μ ν•λ κ¶ν•μ„ κ°€μ§„ **λ°λ › ν‚¤**λ¥Ό μ κ³µν•©λ‹λ‹¤. μ΄ ν‚¤λ” μ‹λ™μ„ κ±Έκ³  λ¬Έμ„ μ κΈ€ μ μμ§€λ§ νΈλ ν¬λ‚ κΈ€λ¬λΈ λ°•μ¤λ¥Ό μ—΄ μλ” μ—†μµλ‹λ‹¤.

μ΄ λΉ„μ μ—μ„:

- **λ‹Ήμ‹ **μ€ **μ‚¬μ©μ**μ…λ‹λ‹¤.
- **λ‹Ήμ‹ μ μλ™μ°¨**λ” κ·€μ¤‘ν• λ„κµ¬μ™€ λ°μ΄ν„°λ¥Ό κ°€μ§„ **MCP μ„λ²„**μ…λ‹λ‹¤.
- **λ°λ ›**μ€ **Microsoft Entra ID**μ…λ‹λ‹¤.
- **μ£Όμ°¨ μ”μ›**μ€ **MCP ν΄λΌμ΄μ–ΈνΈ** (μ„λ²„μ— μ•΅μ„Έμ¤ν•λ ¤λ” μ• ν”λ¦¬μΌ€μ΄μ…)μ…λ‹λ‹¤.
- **λ°λ › ν‚¤**λ” **μ•΅μ„Έμ¤ ν† ν°**μ…λ‹λ‹¤.

μ•΅μ„Έμ¤ ν† ν°μ€ MCP ν΄λΌμ΄μ–ΈνΈκ°€ λ΅κ·ΈμΈ ν›„ Entra IDλ΅λ¶€ν„° λ°›λ” μ•μ „ν• ν…μ¤νΈ λ¬Έμμ—΄μ…λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈλ” λ¨λ“  μ”μ²­κ³Ό ν•¨κ» μ΄ ν† ν°μ„ MCP μ„λ²„μ— μ μ‹ν•©λ‹λ‹¤. μ„λ²„λ” ν† ν°μ„ ν™•μΈν•μ—¬ μ”μ²­μ΄ ν•©λ²•μ μ΄κ³  ν΄λΌμ΄μ–ΈνΈκ°€ ν•„μ”ν• κ¶ν•μ„ κ°€μ§€κ³  μλ”μ§€ ν™•μΈν•  μ μμΌλ©°, μ‹¤μ  μκ²© μ¦λ…(μ: μ•”νΈ)μ„ μ²λ¦¬ν•  ν•„μ”κ°€ μ—†μµλ‹λ‹¤.

### μΈμ¦ νλ¦„

λ‹¤μμ€ μ‹¤μ  ν”„λ΅μ„Έμ¤ μ‘λ™ λ°©μ‹μ…λ‹λ‹¤:

```mermaid
sequenceDiagram
    actor User as π‘¤ μ‚¬μ©μ
    participant Client as π–¥οΈ MCP ν΄λΌμ΄μ–ΈνΈ
    participant Entra as π” Microsoft Entra ID
    participant Server as π”§ MCP μ„λ²„

    Client->>+User: κ³„μ†ν•λ ¤λ©΄ λ΅κ·ΈμΈν•μ‹­μ‹μ¤.
    User->>+Entra: μκ²© μ¦λ…(μ‚¬μ©μ μ΄λ¦„/μ•”νΈ) μ…λ ¥.
    Entra-->>Client: μ•΅μ„Έμ¤ ν† ν°μ…λ‹λ‹¤.
    User-->>-Client: (μ• ν”λ¦¬μΌ€μ΄μ…μΌλ΅ λμ•„κ°)

    Client->>+Server: λ„κµ¬λ¥Ό μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤. μ•΅μ„Έμ¤ ν† ν°μ…λ‹λ‹¤.
    Server->>+Entra: μ΄ μ•΅μ„Έμ¤ ν† ν°μ΄ μ ν¨ν•©λ‹κΉ?
    Entra-->>-Server: μ, μ ν¨ν•©λ‹λ‹¤.
    Server-->>-Client: ν† ν°μ΄ μ ν¨ν•©λ‹λ‹¤. λ„κµ¬ κ²°κ³Όμ…λ‹λ‹¤.
```

### Microsoft μΈμ¦ λΌμ΄λΈλ¬λ¦¬(MSAL) μ†κ°

μ½”λ“λ¥Ό μ‚΄ν΄λ³΄κΈ° μ „μ— μμ‹μ—μ„ λ³΄κ² λ  ν•µμ‹¬ κµ¬μ„± μ”μ†μΈ **Microsoft μΈμ¦ λΌμ΄λΈλ¬λ¦¬(MSAL)**λ¥Ό μ†κ°ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.

MSALμ€ κ°λ°μκ°€ μΈμ¦μ„ ν›¨μ”¬ μ‰½κ² μ²λ¦¬ν•  μ μλ„λ΅ Microsoftμ—μ„ κ°λ°ν• λΌμ΄λΈλ¬λ¦¬μ…λ‹λ‹¤. λ³΄μ• ν† ν° μ²λ¦¬, λ΅κ·ΈμΈ κ΄€λ¦¬ λ° μ„Έμ… μƒλ΅ κ³ μΉ¨κ³Ό κ°™μ€ λ³µμ΅ν• μ½”λ“λ¥Ό λ¨λ‘ μ‘μ„±ν•  ν•„μ” μ—†μ΄ MSALμ΄ μ–΄λ ¤μ΄ μ‘μ—…μ„ μ²λ¦¬ν•©λ‹λ‹¤.

MSALκ³Ό κ°™μ€ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ κ°•λ ¥ν κ¶μ¥λλ” μ΄μ λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

- **μ•μ „ν•©λ‹λ‹¤:** μ—…κ³„ ν‘μ¤€ ν”„λ΅ν† μ½ λ° λ³΄μ• λ¨λ²” μ‚¬λ΅€λ¥Ό κµ¬ν„ν•μ—¬ μ½”λ“μ μ·¨μ•½μ„± μ„ν—μ„ μ¤„μ…λ‹λ‹¤.
- **κ°λ°μ„ λ‹¨μν™”ν•©λ‹λ‹¤:** OAuth 2.0 λ° OpenID Connect ν”„λ΅ν† μ½μ λ³µμ΅μ„±μ„ μ¶”μƒν™”ν•μ—¬ λ‡ μ¤„μ μ½”λ“λ§μΌλ΅ μ• ν”λ¦¬μΌ€μ΄μ…μ— κ°•λ ¥ν• μΈμ¦μ„ μ¶”κ°€ν•  μ μμµλ‹λ‹¤.
- **μ μ§€ κ΄€λ¦¬λ©λ‹λ‹¤:** Microsoftλ” μƒλ΅μ΄ λ³΄μ• μ„ν‘ λ° ν”λ«νΌ λ³€κ²½ μ‚¬ν•­μ„ ν•΄κ²°ν•κΈ° μ„ν•΄ MSALμ„ μ κ·Ήμ μΌλ΅ μ μ§€ κ΄€λ¦¬ν•κ³  μ—…λ°μ΄νΈν•©λ‹λ‹¤.

MSALμ€ .NET, JavaScript/TypeScript, Python, Java, Go λ° iOS λ° Androidμ™€ κ°™μ€ λ¨λ°”μΌ ν”λ«νΌμ„ ν¬ν•¨ν• λ‹¤μ–‘ν• μ–Έμ–΄ λ° μ• ν”λ¦¬μΌ€μ΄μ… ν”„λ μ„μ›ν¬λ¥Ό μ§€μ›ν•©λ‹λ‹¤. μ¦‰, μ „μ²΄ κΈ°μ  μ¤νƒμ—μ„ λ™μΌν• μΌκ΄€λ μΈμ¦ ν¨ν„΄μ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

MSALμ— λ€ν•΄ μμ„Έν μ•μ•„λ³΄λ ¤λ©΄ κ³µμ‹ [MSAL κ°μ” λ¬Έμ„](https://learn.microsoft.com/entra/identity-platform/msal-overview)λ¥Ό μ°Έμ΅°ν•μ‹­μ‹μ¤.

---

## Entra IDλ΅ MCP μ„λ²„ λ³΄νΈ: λ‹¨κ³„λ³„ κ°€μ΄λ“

μ΄μ  Entra IDλ¥Ό μ‚¬μ©ν•μ—¬ λ΅μ»¬ MCP μ„λ²„(`stdio`λ¥Ό ν†µν•΄ ν†µμ‹ ν•λ” μ„λ²„)λ¥Ό λ³΄νΈν•λ” λ°©λ²•μ„ μ‚΄ν΄λ³΄κ² μµλ‹λ‹¤. μ΄ μμ‹λ” λ°μ¤ν¬ν†± μ•± λλ” λ΅μ»¬ κ°λ° μ„λ²„μ™€ κ°™μ΄ μ‚¬μ©μ μ»΄ν“¨ν„°μ—μ„ μ‹¤ν–‰λλ” μ• ν”λ¦¬μΌ€μ΄μ…μ— μ ν•©ν• **κ³µκ° ν΄λΌμ΄μ–ΈνΈ**λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.

### μ‹λ‚λ¦¬μ¤ 1: λ΅μ»¬ MCP μ„λ²„ λ³΄νΈ (κ³µκ° ν΄λΌμ΄μ–ΈνΈ μ‚¬μ©)

μ΄ μ‹λ‚λ¦¬μ¤μ—μ„λ” λ΅μ»¬μ—μ„ μ‹¤ν–‰λκ³  `stdio`λ¥Ό ν†µν•΄ ν†µμ‹ ν•λ©°, λ„κµ¬μ— λ€ν• μ•΅μ„Έμ¤λ¥Ό ν—μ©ν•κΈ° μ „μ— μ‚¬μ©μλ¥Ό μΈμ¦ν•κΈ° μ„ν•΄ Entra IDλ¥Ό μ‚¬μ©ν•λ” MCP μ„λ²„λ¥Ό μ‚΄ν΄λ΄…λ‹λ‹¤. μ„λ²„μ—λ” Microsoft Graph APIμ—μ„ μ‚¬μ©μ ν”„λ΅ν•„ μ •λ³΄λ¥Ό κ°€μ Έμ¤λ” λ‹¨μΌ λ„κµ¬κ°€ μμµλ‹λ‹¤.

#### 1. Entra IDμ—μ„ μ• ν”λ¦¬μΌ€μ΄μ… μ„¤μ •

μ½”λ“λ¥Ό μ‘μ„±ν•κΈ° μ „μ— Microsoft Entra IDμ— μ• ν”λ¦¬μΌ€μ΄μ…μ„ λ“±λ΅ν•΄μ•Ό ν•©λ‹λ‹¤. μ΄λ” Entra IDμ— μ• ν”λ¦¬μΌ€μ΄μ…μ— λ€ν•΄ μ•λ¦¬κ³  μΈμ¦ μ„λΉ„μ¤λ¥Ό μ‚¬μ©ν•  κ¶ν•μ„ λ¶€μ—¬ν•©λ‹λ‹¤.

1. **[Microsoft Entra ν¬ν„Έ](https://entra.microsoft.com/)**λ΅ μ΄λ™ν•©λ‹λ‹¤.
2. **μ•± λ“±λ΅**μΌλ΅ μ΄λ™ν•μ—¬ **μƒ λ“±λ΅**μ„ ν΄λ¦­ν•©λ‹λ‹¤.
3. μ• ν”λ¦¬μΌ€μ΄μ…μ— μ΄λ¦„ μ§€μ • (μ: "λ‚΄ λ΅μ»¬ MCP μ„λ²„").
4. **μ§€μ›λλ” κ³„μ • μ ν•**μ κ²½μ° **μ΄ μ΅°μ§ λ””λ ‰ν„°λ¦¬μ κ³„μ •λ§**μ„ μ„ νƒν•©λ‹λ‹¤.
5. μ΄ μμ‹μ—μ„λ” **λ¦¬λ””λ ‰μ… URI**λ¥Ό λΉ„μ›λ‘ μ μμµλ‹λ‹¤.
6. **λ“±λ΅**μ„ ν΄λ¦­ν•©λ‹λ‹¤.

λ“±λ΅λλ©΄ **μ• ν”λ¦¬μΌ€μ΄μ…(ν΄λΌμ΄μ–ΈνΈ) ID** λ° **λ””λ ‰ν„°λ¦¬(ν…λ„νΈ) ID**λ¥Ό κΈ°λ΅ν•΄ λ‘μ‹­μ‹μ¤. μ½”λ“μ—μ„ ν•„μ”ν•©λ‹λ‹¤.

#### 2. μ½”λ“: λ¶„μ„

μΈμ¦μ„ μ²λ¦¬ν•λ” μ½”λ“μ μ£Όμ” λ¶€λ¶„μ„ μ‚΄ν΄λ³΄κ² μµλ‹λ‹¤. μ΄ μμ‹μ μ „μ²΄ μ½”λ“λ” [mcp-auth-servers GitHub μ €μ¥μ†](https://github.com/Azure-Samples/mcp-auth-servers)μ [Entra ID - Local - WAM](https://github.com/Azure-Samples/mcp-auth-servers/tree/main/src/entra-id-local-wam) ν΄λ”μ—μ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

**`AuthenticationService.cs`**

μ΄ ν΄λμ¤λ” Entra IDμ™€μ μƒνΈ μ‘μ©μ„ μ²λ¦¬ν•©λ‹λ‹¤.

- **`CreateAsync`**: μ΄ λ©”μ„λ“λ” MSAL(Microsoft μΈμ¦ λΌμ΄λΈλ¬λ¦¬)μ—μ„ `PublicClientApplication`μ„ μ΄κΈ°ν™”ν•©λ‹λ‹¤. μ• ν”λ¦¬μΌ€μ΄μ…μ `clientId` λ° `tenantId`λ΅ κµ¬μ„±λ©λ‹λ‹¤.
- **`WithBroker`**: μ΄λ” λΈλ΅μ»¤(μ: Windows μ›Ή κ³„μ • κ΄€λ¦¬μ) μ‚¬μ©μ„ ν™μ„±ν™”ν•μ—¬ λ” μ•μ „ν•κ³  μ›ν™ν• λ‹¨μΌ λ΅κ·ΈμΈ ν™κ²½μ„ μ κ³µν•©λ‹λ‹¤.
- **`AcquireTokenAsync`**: μ΄κ²ƒμ΄ ν•µμ‹¬ λ©”μ„λ“μ…λ‹λ‹¤. λ¨Όμ € ν† ν°μ„ μλ™μΌλ΅ κ°€μ Έμ¤λ ¤κ³  μ‹λ„ν•©λ‹λ‹¤(μ ν¨ν• μ„Έμ…μ΄ μ΄λ―Έ μλ” κ²½μ° μ‚¬μ©μκ°€ λ‹¤μ‹ λ΅κ·ΈμΈν•  ν•„μ”κ°€ μ—†μμ„ μλ―Έ). μλ™ ν† ν°μ„ κ°€μ Έμ¬ μ μ—†μΌλ©΄ μ‚¬μ©μμ—κ² λ€ν™”μ‹μΌλ΅ λ΅κ·ΈμΈν•λΌλ” λ©”μ‹μ§€λ¥Ό ν‘μ‹ν•©λ‹λ‹¤.

```csharp
// λ…ν™•μ„±μ„ μ„ν•΄ λ‹¨μν™”
public static async Task<AuthenticationService> CreateAsync(ILogger<AuthenticationService> logger)
{
    var msalClient = PublicClientApplicationBuilder
        .Create(_clientId) // μ• ν”λ¦¬μΌ€μ΄μ…(ν΄λΌμ΄μ–ΈνΈ) ID
        .WithAuthority(AadAuthorityAudience.AzureAdMyOrg)
        .WithTenantId(_tenantId) // λ””λ ‰ν„°λ¦¬(ν…λ„νΈ) ID
        .WithBroker(new BrokerOptions(BrokerOptions.OperatingSystems.Windows))
        .Build();

    // ... μΊμ‹ λ“±λ΅ ...

    return new AuthenticationService(logger, msalClient);
}

public async Task<string> AcquireTokenAsync()
{
    try
    {
        // λ¨Όμ € μλ™ μΈμ¦ μ‹λ„
        var accounts = await _msalClient.GetAccountsAsync();
        var account = accounts.FirstOrDefault();

        AuthenticationResult? result = null;

        if (account != null)
        {
            result = await _msalClient.AcquireTokenSilent(_scopes, account).ExecuteAsync();
        }
        else
        {
            // κ³„μ •μ΄ μ—†κ±°λ‚ μλ™ μΈμ¦μ΄ μ‹¤ν¨ν•λ©΄ λ€ν™”μ‹μΌλ΅ μ§„ν–‰
            result = await _msalClient.AcquireTokenInteractive(_scopes).ExecuteAsync();
        }

        return result.AccessToken;
    }
    catch (Exception ex)
    {
        _logger.LogError(ex, "ν† ν° νλ“ μ¤‘ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤.");
        throw; // μ„ νƒμ μΌλ΅ μƒμ„ μμ¤€ μ²λ¦¬λ¥Ό μ„ν•΄ μμ™Έ λ‹¤μ‹ throw
    }
}
```

**`Program.cs`**

μ—¬κΈ°μ—μ„ MCP μ„λ²„κ°€ μ„¤μ •λκ³  μΈμ¦ μ„λΉ„μ¤κ°€ ν†µν•©λ©λ‹λ‹¤.

- **`AddSingleton<AuthenticationService>`**: μ΄λ” `AuthenticationService`λ¥Ό μΆ…μ†μ„± μ£Όμ… μ»¨ν…μ΄λ„μ— λ“±λ΅ν•μ—¬ μ• ν”λ¦¬μΌ€μ΄μ…μ λ‹¤λ¥Έ λ¶€λ¶„(μ: λ„κµ¬)μ—μ„ μ‚¬μ©ν•  μ μλ„λ΅ ν•©λ‹λ‹¤.
- **`GetUserDetailsFromGraph` λ„κµ¬**: μ΄ λ„κµ¬λ” `AuthenticationService` μΈμ¤ν„΄μ¤λ¥Ό ν•„μ”λ΅ ν•©λ‹λ‹¤. μ‘μ—…μ„ μν–‰ν•κΈ° μ „μ— `authService.AcquireTokenAsync()`λ¥Ό νΈμ¶ν•μ—¬ μ ν¨ν• μ•΅μ„Έμ¤ ν† ν°μ„ κ°€μ Έμµλ‹λ‹¤. μΈμ¦μ΄ μ„±κ³µν•λ©΄ ν† ν°μ„ μ‚¬μ©ν•μ—¬ Microsoft Graph APIλ¥Ό νΈμ¶ν•κ³  μ‚¬μ©μ μ„Έλ¶€ μ •λ³΄λ¥Ό κ°€μ Έμµλ‹λ‹¤.

```csharp
// λ…ν™•μ„±μ„ μ„ν•΄ λ‹¨μν™”
[McpServerTool(Name = "GetUserDetailsFromGraph")]
public static async Task<string> GetUserDetailsFromGraph(
    AuthenticationService authService)
{
    try
    {
        // μΈμ¦ νλ¦„μ„ νΈλ¦¬κ±°ν•©λ‹λ‹¤.
        var accessToken = await authService.AcquireTokenAsync();

        // ν† ν°μ„ μ‚¬μ©ν•μ—¬ GraphServiceClient μƒμ„±
        var graphClient = new GraphServiceClient(
            new BaseBearerTokenAuthenticationProvider(new TokenProvider(authService)));

        var user = await graphClient.Me.GetAsync();

        return System.Text.Json.JsonSerializer.Serialize(user);
    }
    catch (Exception ex)
    {
        return $"μ¤λ¥: {ex.Message}";
    }
}
```

#### 3. λ¨λ“  κ²ƒμ΄ ν•¨κ» μ‘λ™ν•λ” λ°©μ‹

1. MCP ν΄λΌμ΄μ–ΈνΈκ°€ `GetUserDetailsFromGraph` λ„κµ¬λ¥Ό μ‚¬μ©ν•λ ¤κ³  ν•λ©΄ λ„κµ¬λ” λ¨Όμ € `AcquireTokenAsync`λ¥Ό νΈμ¶ν•©λ‹λ‹¤.
2. `AcquireTokenAsync`λ” MSAL λΌμ΄λΈλ¬λ¦¬κ°€ μ ν¨ν• ν† ν°μ„ ν™•μΈν•λ„λ΅ νΈλ¦¬κ±°ν•©λ‹λ‹¤.
3. ν† ν°μ„ μ°Ύμ„ μ μ—†μΌλ©΄ MSALμ€ λΈλ΅μ»¤λ¥Ό ν†µν•΄ μ‚¬μ©μμ—κ² Entra ID κ³„μ •μΌλ΅ λ΅κ·ΈμΈν•λΌλ” λ©”μ‹μ§€λ¥Ό ν‘μ‹ν•©λ‹λ‹¤.
4. μ‚¬μ©μκ°€ λ΅κ·ΈμΈν•λ©΄ Entra IDλ” μ•΅μ„Έμ¤ ν† ν°μ„ λ°κΈ‰ν•©λ‹λ‹¤.
5. λ„κµ¬λ” ν† ν°μ„ μμ‹ ν•κ³  μ΄λ¥Ό μ‚¬μ©ν•μ—¬ Microsoft Graph APIμ— λ€ν• λ³΄μ• νΈμ¶μ„ μν–‰ν•©λ‹λ‹¤.
6. μ‚¬μ©μ μ„Έλ¶€ μ •λ³΄κ°€ MCP ν΄λΌμ΄μ–ΈνΈμ— λ°ν™λ©λ‹λ‹¤.

μ΄ ν”„λ΅μ„Έμ¤λ” μΈμ¦λ μ‚¬μ©μλ§ λ„κµ¬λ¥Ό μ‚¬μ©ν•  μ μλ„λ΅ λ³΄μ¥ν•μ—¬ λ΅μ»¬ MCP μ„λ²„λ¥Ό ν¨κ³Όμ μΌλ΅ λ³΄νΈν•©λ‹λ‹¤.

### μ‹λ‚λ¦¬μ¤ 2: μ›κ²© MCP μ„λ²„ λ³΄νΈ (κΈ°λ°€ ν΄λΌμ΄μ–ΈνΈ μ‚¬μ©)

MCP μ„λ²„κ°€ μ›κ²© λ¨Έμ‹ (μ: ν΄λΌμ°λ“ μ„λ²„)μ—μ„ μ‹¤ν–‰λκ³  HTTP μ¤νΈλ¦¬λ°κ³Ό κ°™μ€ ν”„λ΅ν† μ½μ„ ν†µν•΄ ν†µμ‹ ν•λ” κ²½μ° λ³΄μ• μ”κµ¬ μ‚¬ν•­μ΄ λ‹¤λ¦…λ‹λ‹¤. μ΄ κ²½μ° **κΈ°λ°€ ν΄λΌμ΄μ–ΈνΈ**μ™€ **κ¶ν• λ¶€μ—¬ μ½”λ“ νλ¦„**μ„ μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤. μ΄λ” μ• ν”λ¦¬μΌ€μ΄μ…μ λΉ„λ°€μ΄ λΈλΌμ°μ €μ— λ…Έμ¶λμ§€ μ•μΌλ―€λ΅ λ” μ•μ „ν• λ°©λ²•μ…λ‹λ‹¤.

μ΄ μμ‹λ” Express.jsλ¥Ό μ‚¬μ©ν•μ—¬ HTTP μ”μ²­μ„ μ²λ¦¬ν•λ” TypeScript κΈ°λ° MCP μ„λ²„λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.

#### 1. Entra IDμ—μ„ μ• ν”λ¦¬μΌ€μ΄μ… μ„¤μ •

Entra IDμ μ„¤μ •μ€ κ³µκ° ν΄λΌμ΄μ–ΈνΈμ™€ μ μ‚¬ν•μ§€λ§ ν• κ°€μ§€ μ£Όμ” μ°¨μ΄μ μ΄ μμµλ‹λ‹¤. **ν΄λΌμ΄μ–ΈνΈ λΉ„λ°€**μ„ μƒμ„±ν•΄μ•Ό ν•©λ‹λ‹¤.

1. **[Microsoft Entra ν¬ν„Έ](https://entra.microsoft.com/)**λ΅ μ΄λ™ν•©λ‹λ‹¤.
2. μ•± λ“±λ΅μ—μ„ **μΈμ¦μ„ λ° λΉ„λ°€** νƒ­μΌλ΅ μ΄λ™ν•©λ‹λ‹¤.
3. **μƒ ν΄λΌμ΄μ–ΈνΈ λΉ„λ°€**μ„ ν΄λ¦­ν•κ³  μ„¤λ…μ„ μ…λ ¥ν• λ‹¤μ **μ¶”κ°€**λ¥Ό ν΄λ¦­ν•©λ‹λ‹¤.
4. **μ¤‘μ”:** λΉ„λ°€ κ°’μ„ μ¦‰μ‹ λ³µμ‚¬ν•μ‹­μ‹μ¤. λ‹¤μ‹ λ³Ό μ μ—†μµλ‹λ‹¤.
5. **λ¦¬λ””λ ‰μ… URI**λ„ κµ¬μ„±ν•΄μ•Ό ν•©λ‹λ‹¤. **μΈμ¦** νƒ­μΌλ΅ μ΄λ™ν•μ—¬ **ν”λ«νΌ μ¶”κ°€**λ¥Ό ν΄λ¦­ν•κ³  **μ›Ή**μ„ μ„ νƒν• λ‹¤μ μ• ν”λ¦¬μΌ€μ΄μ…μ λ¦¬λ””λ ‰μ… URIλ¥Ό μ…λ ¥ν•©λ‹λ‹¤(μ: `http://localhost:3001/auth/callback`).

> **β οΈ μ¤‘μ” λ³΄μ• μ°Έκ³ :** ν”„λ΅λ•μ… μ• ν”λ¦¬μΌ€μ΄μ…μ κ²½μ° Microsoftλ” ν΄λΌμ΄μ–ΈνΈ λΉ„λ°€ λ€μ‹  **κ΄€λ¦¬ ID** λλ” **μ›ν¬λ΅λ“ ID νλ”λ μ΄μ…**κ³Ό κ°™μ€ **λΉ„λ°€ μ—†λ” μΈμ¦** λ°©λ²•μ„ μ‚¬μ©ν•λ” κ²ƒμ„ κ°•λ ¥ν κ¶μ¥ν•©λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈ λΉ„λ°€μ€ λ…Έμ¶λκ±°λ‚ μ†μƒλ  μ μμΌλ―€λ΅ λ³΄μ• μ„ν—μ„ μ΄λν•©λ‹λ‹¤. κ΄€λ¦¬ IDλ” μ½”λ“ λλ” κµ¬μ„±μ— μκ²© μ¦λ…μ„ μ €μ¥ν•  ν•„μ”λ¥Ό μ—†μ• μ„ λ” μ•μ „ν• μ ‘κ·Ό λ°©μ‹μ„ μ κ³µν•©λ‹λ‹¤.
>
> κ΄€λ¦¬ ID λ° κµ¬ν„ λ°©λ²•μ— λ€ν• μμ„Έν• λ‚΄μ©μ€ [Azure λ¦¬μ†μ¤μ— λ€ν• κ΄€λ¦¬ ID κ°μ”](https://learn.microsoft.com/entra/identity/managed-identities-azure-resources/overview)λ¥Ό μ°Έμ΅°ν•μ‹­μ‹μ¤.

#### 2. μ½”λ“: λ¶„μ„

μ΄ μμ‹λ” μ„Έμ… κΈ°λ° μ ‘κ·Ό λ°©μ‹μ„ μ‚¬μ©ν•©λ‹λ‹¤. μ‚¬μ©μκ°€ μΈμ¦ν•λ©΄ μ„λ²„λ” μ•΅μ„Έμ¤ ν† ν°κ³Ό μƒλ΅ κ³ μΉ¨ ν† ν°μ„ μ„Έμ…μ— μ €μ¥ν•κ³  μ‚¬μ©μμ—κ² μ„Έμ… ν† ν°μ„ μ κ³µν•©λ‹λ‹¤. μ΄ μ„Έμ… ν† ν°μ€ μ΄ν›„ μ”μ²­μ— μ‚¬μ©λ©λ‹λ‹¤. μ΄ μμ‹μ μ „μ²΄ μ½”λ“λ” [mcp-auth-servers GitHub μ €μ¥μ†](https://github.com/Azure-Samples/mcp-auth-servers)μ [Entra ID - Confidential client](https://github.com/Azure-Samples/mcp-auth-servers/tree/main/src/entra-id-cca-session) ν΄λ”μ—μ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

**`Server.ts`**

μ΄ νμΌμ€ Express μ„λ²„μ™€ MCP μ „μ†΅ κ³„μΈµμ„ μ„¤μ •ν•©λ‹λ‹¤.

- **`requireBearerAuth`**: `/sse` λ° `/message` μ—”λ“ν¬μΈνΈλ¥Ό λ³΄νΈν•λ” λ―Έλ“¤μ›¨μ–΄μ…λ‹λ‹¤. μ”μ²­μ `Authorization` ν—¤λ”μ— μ ν¨ν• λ² μ–΄λ¬ ν† ν°μ΄ μλ”μ§€ ν™•μΈν•©λ‹λ‹¤.
- **`EntraIdServerAuthProvider`**: `McpServerAuthorizationProvider` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ” μ‚¬μ©μ μ§€μ • ν΄λμ¤μ…λ‹λ‹¤. OAuth 2.0 νλ¦„μ„ μ²λ¦¬ν•©λ‹λ‹¤.
- **`/auth/callback`**: μ΄ μ—”λ“ν¬μΈνΈλ” μ‚¬μ©μκ°€ μΈμ¦ν• ν›„ Entra IDμ λ¦¬λ””λ ‰μ…μ„ μ²λ¦¬ν•©λ‹λ‹¤. κ¶ν• λ¶€μ—¬ μ½”λ“λ¥Ό μ•΅μ„Έμ¤ ν† ν° λ° μƒλ΅ κ³ μΉ¨ ν† ν°μΌλ΅ κµν™ν•©λ‹λ‹¤.

```typescript
// λ…ν™•μ„±μ„ μ„ν•΄ λ‹¨μν™”
const app = express();
const { server } = createServer();
const provider = new EntraIdServerAuthProvider();

// SSE μ—”λ“ν¬μΈνΈ λ³΄νΈ
app.get("/sse", requireBearerAuth({
  provider,
  requiredScopes: ["User.Read"]
}), async (req, res) => {
  // ... μ „μ†΅μ— μ—°κ²° ...
});

// λ©”μ‹μ§€ μ—”λ“ν¬μΈνΈ λ³΄νΈ
app.post("/message", requireBearerAuth({
  provider,
  requiredScopes: ["User.Read"]
}), async (req, res) => {
  // ... λ©”μ‹μ§€ μ²λ¦¬ ...
});

// OAuth 2.0 μ½λ°± μ²λ¦¬
app.get("/auth/callback", (req, res) => {
  provider.handleCallback(req.query.code, req.query.state)
    .then(result => {
      // ... μ„±κ³µ λλ” μ‹¤ν¨ μ²λ¦¬ ...
    });
});
```

**`Tools.ts`**

μ΄ νμΌμ€ MCP μ„λ²„κ°€ μ κ³µν•λ” λ„κµ¬λ¥Ό μ •μν•©λ‹λ‹¤. `getUserDetails` λ„κµ¬λ” μ΄μ „ μμ‹μ™€ μ μ‚¬ν•μ§€λ§ μ„Έμ…μ—μ„ μ•΅μ„Έμ¤ ν† ν°μ„ κ°€μ Έμµλ‹λ‹¤.

```typescript
// λ…ν™•μ„±μ„ μ„ν•΄ λ‹¨μν™”
server.setRequestHandler(CallToolRequestSchema, async (request) => {
  const { name } = request.params;
  const context = request.params?.context as { token?: string } | undefined;
  const sessionToken = context?.token;

  if (name === ToolName.GET_USER_DETAILS) {
    if (!sessionToken) {
      throw new AuthenticationError("μΈμ¦ ν† ν°μ΄ μ—†κ±°λ‚ μ ν¨ν•μ§€ μ•μµλ‹λ‹¤. μ”μ²­ μ»¨ν…μ¤νΈμ— ν† ν°μ΄ μ κ³µλμ—λ”μ§€ ν™•μΈν•μ‹­μ‹μ¤.");
    }

    // μ„Έμ… μ €μ¥μ†μ—μ„ Entra ID ν† ν° κ°€μ Έμ¤κΈ°
    const tokenData = tokenStore.getToken(sessionToken);
    const entraIdToken = tokenData.accessToken;

    const graphClient = Client.init({
      authProvider: (done) => {
        done(null, entraIdToken);
      }
    });

    const user = await graphClient.api('/me').get();

    // ... μ‚¬μ©μ μ„Έλ¶€ μ •λ³΄ λ°ν™ ...
  }
});
```

**`auth/EntraIdServerAuthProvider.ts`**

μ΄ ν΄λμ¤λ” λ‹¤μ λ…Όλ¦¬λ¥Ό μ²λ¦¬ν•©λ‹λ‹¤:

- μ‚¬μ©μ Entra ID λ΅κ·ΈμΈ νμ΄μ§€λ΅ λ¦¬λ””λ ‰μ…
- κ¶ν• λ¶€μ—¬ μ½”λ“λ¥Ό μ•΅μ„Έμ¤ ν† ν°μΌλ΅ κµν™
- `tokenStore`μ— ν† ν° μ €μ¥
- μ•΅μ„Έμ¤ ν† ν° λ§λ£ μ‹ μƒλ΅ κ³ μΉ¨

#### 3. λ¨λ“  κ²ƒμ΄ ν•¨κ» μ‘λ™ν•λ” λ°©μ‹

1. μ‚¬μ©μκ°€ MCP μ„λ²„μ— μ²μ μ—°κ²°ν•λ ¤κ³  ν•λ©΄ `requireBearerAuth` λ―Έλ“¤μ›¨μ–΄λ” μ ν¨ν• μ„Έμ…μ΄ μ—†μμ„ ν™•μΈν•κ³  Entra ID λ΅κ·ΈμΈ νμ΄μ§€λ΅ λ¦¬λ””λ ‰μ…ν•©λ‹λ‹¤.
2. μ‚¬μ©μλ” Entra ID κ³„μ •μΌλ΅ λ΅κ·ΈμΈν•©λ‹λ‹¤.
3. Entra IDλ” κ¶ν• λ¶€μ—¬ μ½”λ“μ™€ ν•¨κ» μ‚¬μ©μλ¥Ό `/auth/callback` μ—”λ“ν¬μΈνΈλ΅ λ‹¤μ‹ λ¦¬λ””λ ‰μ…ν•©λ‹λ‹¤.
4. μ„λ²„λ” μ½”λ“λ¥Ό μ•΅μ„Έμ¤ ν† ν° λ° μƒλ΅ κ³ μΉ¨ ν† ν°μΌλ΅ κµν™ν•κ³ , μ΄λ¥Ό μ €μ¥ν•κ³ , ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅λλ” μ„Έμ… ν† ν°μ„ μƒμ„±ν•©λ‹λ‹¤.
5. ν΄λΌμ΄μ–ΈνΈλ” μ΄μ  μ΄ μ„Έμ… ν† ν°μ„ MCP μ„λ²„μ— λ€ν• λ¨λ“  ν–¥ν›„ μ”μ²­μ— λ€ν• `Authorization` ν—¤λ”μ—μ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.
6. `getUserDetails` λ„κµ¬κ°€ νΈμ¶λλ©΄ μ„Έμ… ν† ν°μ„ μ‚¬μ©ν•μ—¬ Entra ID μ•΅μ„Έμ¤ ν† ν°μ„ μ΅°νν• λ‹¤μ μ΄λ¥Ό μ‚¬μ©ν•μ—¬ Microsoft Graph APIλ¥Ό νΈμ¶ν•©λ‹λ‹¤.

μ΄ νλ¦„μ€ κ³µκ° ν΄λΌμ΄μ–ΈνΈ νλ¦„λ³΄λ‹¤ λ³µμ΅ν•μ§€λ§ μΈν„°λ„·μ— λ…Έμ¶λλ” μ—”λ“ν¬μΈνΈμ— ν•„μ”ν•©λ‹λ‹¤. μ›κ²© MCP μ„λ²„λ” κ³µμ© μΈν„°λ„·μ„ ν†µν•΄ μ•΅μ„Έμ¤ν•  μ μμΌλ―€λ΅ λ¬΄λ‹¨ μ•΅μ„Έμ¤ λ° μ μ¬μ  κ³µκ²©μΌλ΅λ¶€ν„° λ³΄νΈν•κΈ° μ„ν•΄ λ” κ°•λ ¥ν• λ³΄μ• μ΅°μΉκ°€ ν•„μ”ν•©λ‹λ‹¤.


## λ³΄μ• λ¨λ²” μ‚¬λ΅€

- **ν•­μƒ HTTPS μ‚¬μ©**: ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ ν†µμ‹ μ„ μ•”νΈν™”ν•μ—¬ ν† ν°μ΄ κ°€λ΅μ±„μ΄λ” κ²ƒμ„ λ°©μ§€ν•©λ‹λ‹¤.
- **μ—­ν•  κΈ°λ° μ•΅μ„Έμ¤ μ μ–΄(RBAC) κµ¬ν„**: μ‚¬μ©μκ°€ μΈμ¦λμ—λ”μ§€ μ—¬λ¶€λ§ ν™•μΈν•μ§€ λ§κ³ , *λ¬΄μ—‡μ„* ν•  μ μλ”μ§€ ν™•μΈν•μ‹­μ‹μ¤. Entra IDμ—μ„ μ—­ν• μ„ μ •μν•κ³  MCP μ„λ²„μ—μ„ μ΄λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.
- **λ¨λ‹ν„°λ§ λ° κ°μ‚¬**: λ¨λ“  μΈμ¦ μ΄λ²¤νΈλ¥Ό λ΅κΉ…ν•μ—¬ μμ‹¬μ¤λ¬μ΄ ν™λ™μ„ κ°μ§€ν•κ³  λ€μ‘ν•  μ μλ„λ΅ ν•©λ‹λ‹¤.
- **μ†λ„ μ ν• λ° μ¤λ΅ν‹€λ§ μ²λ¦¬**: Microsoft Graph λ° κΈ°νƒ€ APIλ” λ‚¨μ©μ„ λ°©μ§€ν•κΈ° μ„ν•΄ μ†λ„ μ ν•μ„ κµ¬ν„ν•©λ‹λ‹¤. MCP μ„λ²„μ—μ„ μ§€μ λ°±μ¤ν”„ λ° μ¬μ‹λ„ λ…Όλ¦¬λ¥Ό κµ¬ν„ν•μ—¬ HTTP 429 (μ”μ²­μ΄ λ„λ¬΄ λ§μ) μ‘λ‹µμ„ μ°μ•„ν•κ² μ²λ¦¬ν•μ‹­μ‹μ¤. μμ£Ό μ•΅μ„Έμ¤ν•λ” λ°μ΄ν„°λ¥Ό μΊμ‹±ν•μ—¬ API νΈμ¶μ„ μ¤„μ΄λ” κ²ƒμ„ κ³ λ ¤ν•μ‹­μ‹μ¤.
- **μ•μ „ν• ν† ν° μ €μ¥**: μ•΅μ„Έμ¤ ν† ν° λ° μƒλ΅ κ³ μΉ¨ ν† ν°μ„ μ•μ „ν•κ² μ €μ¥ν•μ‹­μ‹μ¤. λ΅μ»¬ μ• ν”λ¦¬μΌ€μ΄μ…μ κ²½μ° μ‹μ¤ν…μ λ³΄μ• μ €μ¥ λ©”μ»¤λ‹μ¦μ„ μ‚¬μ©ν•μ‹­μ‹μ¤. μ„λ²„ μ• ν”λ¦¬μΌ€μ΄μ…μ κ²½μ° μ•”νΈν™”λ μ €μ¥μ† λλ” Azure Key Vaultμ™€ κ°™μ€ λ³΄μ• ν‚¤ κ΄€λ¦¬ μ„λΉ„μ¤λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ„ κ³ λ ¤ν•μ‹­μ‹μ¤.
- **ν† ν° λ§λ£ μ²λ¦¬**: μ•΅μ„Έμ¤ ν† ν°μ€ μλ…μ΄ μ ν•μ μ…λ‹λ‹¤. μƒλ΅ κ³ μΉ¨ ν† ν°μ„ μ‚¬μ©ν•μ—¬ μλ™ ν† ν° μƒλ΅ κ³ μΉ¨μ„ κµ¬ν„ν•μ—¬ λ‹¤μ‹ μΈμ¦ν•  ν•„μ” μ—†μ΄ μ›ν™ν• μ‚¬μ©μ κ²½ν—μ„ μ μ§€ν•μ‹­μ‹μ¤.
- **Azure API Management μ‚¬μ© κ³ λ ¤**: MCP μ„λ²„μ—μ„ μ§μ ‘ λ³΄μ•μ„ κµ¬ν„ν•λ©΄ μ„Έλ¶„ν™”λ μ μ–΄λ¥Ό ν•  μ μμ§€λ§, Azure API Managementμ™€ κ°™μ€ API κ²μ΄νΈμ›¨μ΄λ” μΈμ¦, κ¶ν• λ¶€μ—¬, μ†λ„ μ ν• λ° λ¨λ‹ν„°λ§μ„ ν¬ν•¨ν• μ΄λ¬ν• λ³΄μ• λ¬Έμ  μ¤‘ λ§μ€ λ¶€λ¶„μ„ μλ™μΌλ΅ μ²λ¦¬ν•  μ μμµλ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈμ™€ MCP μ„λ²„ μ‚¬μ΄μ— μ„μΉν•λ” μ¤‘μ•™ μ§‘μ¤‘μ‹ λ³΄μ• κ³„μΈµμ„ μ κ³µν•©λ‹λ‹¤. MCPμ™€ ν•¨κ» API κ²μ΄νΈμ›¨μ΄λ¥Ό μ‚¬μ©ν•λ” λ°©λ²•μ— λ€ν• μμ„Έν• λ‚΄μ©μ€ [Azure API Management MCP μ„λ²„λ¥Ό μ„ν• μΈμ¦ κ²μ΄νΈμ›¨μ΄](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)λ¥Ό μ°Έμ΅°ν•μ‹­μ‹μ¤.


## ν•µμ‹¬ μ”μ•½

- MCP μ„λ²„ λ³΄μ•μ€ λ°μ΄ν„° λ° λ„κµ¬λ¥Ό λ³΄νΈν•λ” λ° μ¤‘μ”ν•©λ‹λ‹¤.
- Microsoft Entra IDλ” μΈμ¦ λ° κ¶ν• λ¶€μ—¬λ¥Ό μ„ν• κ°•λ ¥ν•κ³  ν™•μ¥ κ°€λ¥ν• μ†”λ£¨μ…μ„ μ κ³µν•©λ‹λ‹¤.
- λ΅μ»¬ μ• ν”λ¦¬μΌ€μ΄μ…μ—λ” **κ³µκ° ν΄λΌμ΄μ–ΈνΈ**λ¥Ό μ‚¬μ©ν•κ³  μ›κ²© μ„λ²„μ—λ” **κΈ°λ°€ ν΄λΌμ΄μ–ΈνΈ**λ¥Ό μ‚¬μ©ν•μ‹­μ‹μ¤.
- **κ¶ν• λ¶€μ—¬ μ½”λ“ νλ¦„**μ€ μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ— κ°€μ¥ μ•μ „ν• μµμ…μ…λ‹λ‹¤.


## μ—°μµ

1. κµ¬μ¶•ν•  MCP μ„λ²„μ— λ€ν•΄ μƒκ°ν•΄ λ³΄μ‹­μ‹μ¤. λ΅μ»¬ μ„λ²„μ…λ‹κΉ, μ•„λ‹λ©΄ μ›κ²© μ„λ²„μ…λ‹κΉ?
2. λ‹µλ³€μ„ λ°”νƒ•μΌλ΅ κ³µκ° ν΄λΌμ΄μ–ΈνΈ λλ” κΈ°λ°€ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‚¬μ©ν•μ‹κ² μµλ‹κΉ?
3. MCP μ„λ²„λ” Microsoft Graphμ— λ€ν• μ‘μ—…μ„ μν–‰ν•κΈ° μ„ν•΄ μ–΄λ–¤ κ¶ν•μ„ μ”μ²­ν•©λ‹κΉ?


## μ‹¤μµ

### μ—°μµ 1: Entra IDμ— μ• ν”λ¦¬μΌ€μ΄μ… λ“±λ΅
Microsoft Entra ν¬ν„Έλ΅ μ΄λ™ν•©λ‹λ‹¤.
MCP μ„λ²„μ© μƒ μ• ν”λ¦¬μΌ€μ΄μ…μ„ λ“±λ΅ν•©λ‹λ‹¤.
μ• ν”λ¦¬μΌ€μ΄μ…(ν΄λΌμ΄μ–ΈνΈ) ID λ° λ””λ ‰ν„°λ¦¬(ν…λ„νΈ) IDλ¥Ό κΈ°λ΅ν•©λ‹λ‹¤.

### μ—°μµ 2: λ΅μ»¬ MCP μ„λ²„ λ³΄νΈ (κ³µκ° ν΄λΌμ΄μ–ΈνΈ)
- μ½”λ“ μμ‹λ¥Ό λ”°λΌ μ‚¬μ©μ μΈμ¦μ„ μ„ν•΄ MSAL(Microsoft μΈμ¦ λΌμ΄λΈλ¬λ¦¬)μ„ ν†µν•©ν•©λ‹λ‹¤.
- Microsoft Graphμ—μ„ μ‚¬μ©μ μ„Έλ¶€ μ •λ³΄λ¥Ό κ°€μ Έμ¤λ” MCP λ„κµ¬λ¥Ό νΈμ¶ν•μ—¬ μΈμ¦ νλ¦„μ„ ν…μ¤νΈν•©λ‹λ‹¤.

### μ—°μµ 3: μ›κ²© MCP μ„λ²„ λ³΄νΈ (κΈ°λ°€ ν΄λΌμ΄μ–ΈνΈ)
- Entra IDμ— κΈ°λ°€ ν΄λΌμ΄μ–ΈνΈλ¥Ό λ“±λ΅ν•κ³  ν΄λΌμ΄μ–ΈνΈ λΉ„λ°€μ„ μƒμ„±ν•©λ‹λ‹¤.
- Express.js MCP μ„λ²„κ°€ κ¶ν• λ¶€μ—¬ μ½”λ“ νλ¦„μ„ μ‚¬μ©ν•λ„λ΅ κµ¬μ„±ν•©λ‹λ‹¤.
- λ³΄νΈλ μ—”λ“ν¬μΈνΈλ¥Ό ν…μ¤νΈν•κ³  ν† ν° κΈ°λ° μ•΅μ„Έμ¤λ¥Ό ν™•μΈν•©λ‹λ‹¤.

### μ—°μµ 4: λ³΄μ• λ¨λ²” μ‚¬λ΅€ μ μ©
- λ΅μ»¬ λλ” μ›κ²© μ„λ²„μ— HTTPSλ¥Ό ν™μ„±ν™”ν•©λ‹λ‹¤.
- μ„λ²„ λ…Όλ¦¬μ— μ—­ν•  κΈ°λ° μ•΅μ„Έμ¤ μ μ–΄(RBAC)λ¥Ό κµ¬ν„ν•©λ‹λ‹¤.
- ν† ν° λ§λ£ μ²λ¦¬ λ° μ•μ „ν• ν† ν° μ €μ¥μ„ μ¶”κ°€ν•©λ‹λ‹¤.

## μλ£

1. **MSAL κ°μ” λ¬Έμ„**
   Microsoft μΈμ¦ λΌμ΄λΈλ¬λ¦¬(MSAL)κ°€ ν”λ«νΌ μ „λ°μ— κ±Έμ³ μ•μ „ν• ν† ν° νλ“μ„ κ°€λ¥ν•κ² ν•λ” λ°©λ²•μ„ λ°°μ›λ‹λ‹¤:
   [Microsoft Learnμ MSAL κ°μ”](https://learn.microsoft.com/en-gb/entra/msal/overview)

2. **Azure-Samples/mcp-auth-servers GitHub μ €μ¥μ†**
   μΈμ¦ νλ¦„μ„ λ³΄μ—¬μ£Όλ” MCP μ„λ²„μ μ°Έμ΅° κµ¬ν„:
   [GitHubμ Azure-Samples/mcp-auth-servers](https://github.com/Azure-Samples/mcp-auth-servers)

3. **Azure λ¦¬μ†μ¤μ— λ€ν• κ΄€λ¦¬ ID κ°μ”**
   μ‹μ¤ν… λλ” μ‚¬μ©μ ν• λ‹Ή κ΄€λ¦¬ IDλ¥Ό μ‚¬μ©ν•μ—¬ λΉ„λ°€μ„ μ κ±°ν•λ” λ°©λ²•μ„ μ΄ν•΄ν•©λ‹λ‹¤:
   [Microsoft Learnμ κ΄€λ¦¬ ID κ°μ”](https://learn.microsoft.com/en-us/entra/identity/managed-identities-azure-resources/)

4. **Azure API Management: MCP μ„λ²„λ¥Ό μ„ν• μΈμ¦ κ²μ΄νΈμ›¨μ΄**
   APIMμ„ MCP μ„λ²„λ¥Ό μ„ν• μ•μ „ν• OAuth2 κ²μ΄νΈμ›¨μ΄λ΅ μ‚¬μ©ν•λ” λ°©λ²•μ— λ€ν• μ‹¬μΈµ λ¶„μ„:
   [Azure API Management MCP μ„λ²„λ¥Ό μ„ν• μΈμ¦ κ²μ΄νΈμ›¨μ΄](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)

5. **Microsoft Graph κ¶ν• μ°Έμ΅°**
   Microsoft Graphμ— λ€ν• μ„μ„λ λ° μ• ν”λ¦¬μΌ€μ΄μ… κ¶ν•μ ν¬κ΄„μ μΈ λ©λ΅:
   [Microsoft Graph κ¶ν• μ°Έμ΅°](https://learn.microsoft.com/zh-tw/graph/permissions-reference)



## ν•™μµ κ²°κ³Ό
μ΄ μ„Ήμ…μ„ μ™„λ£ν•λ©΄ λ‹¤μμ„ μν–‰ν•  μ μμµλ‹λ‹¤:

- MCP μ„λ²„ λ° AI μ›ν¬ν”λ΅μ°μ— μΈμ¦μ΄ μ¤‘μ”ν• μ΄μ λ¥Ό λ…ν™•ν•κ² μ„¤λ…
- λ΅μ»¬ λ° μ›κ²© MCP μ„λ²„ μ‹λ‚λ¦¬μ¤ λ¨λ‘μ— λ€ν• Entra ID μΈμ¦ μ„¤μ • λ° κµ¬μ„±
- μ„λ²„ λ°°ν¬μ— λ”°λΌ μ μ ν• ν΄λΌμ΄μ–ΈνΈ μ ν•(κ³µκ° λλ” κΈ°λ°€) μ„ νƒ
- ν† ν° μ €μ¥ λ° μ—­ν•  κΈ°λ° κ¶ν• λ¶€μ—¬λ¥Ό ν¬ν•¨ν• λ³΄μ• μ½”λ”© μ‚¬λ΅€ κµ¬ν„
- MCP μ„λ²„ λ° λ„κµ¬λ¥Ό λ¬΄λ‹¨ μ•΅μ„Έμ¤λ΅λ¶€ν„° μμ‹  μκ² λ³΄νΈ

## λ‹¤μ λ‹¨κ³„

- [5.13 Azure AI Foundryμ™€ λ¨λΈ μ»¨ν…μ¤νΈ ν”„λ΅ν† μ½(MCP) ν†µν•©](../mcp-foundry-agent-integration/README.md)
